<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
  <link rel="stylesheet" type="text/css" href="styles.css" />
  <title>BART-GoogleMap MAshUP</title>
  <script type="text/javascript" src="js/jquery-1.8.0.js"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
  <script>
    function init()
    {
    var elem=document.getElementById('canvas_map');
    var latlng=new google.maps.LatLng(37.752254,-122.418466);
    var opt={zoom:13,
             center:latlng,
             mapTypeId:google.maps.MapTypeId.ROADMAP,
             disableAutoPan:true,
             navigationControl:true,
             navigationControlOptions:{style:google.maps.NavigationControlStyle.small},
             mapTypeControl:true
    };
    var map=new google.maps.Map(elem,opt);

/*    var marker=new google.maps.Marker({position:mark1,title:'24th, Street Mission',map:map});
 *    var marker2=new google.maps.Marker({
 *                  position:mark2,
 *                  title:'16th, Street Mission',
 *                  map:map
 *    });
 *    var marker3=new google.maps.Marker({
 *                  position:mark3,title:'as',map:map
 *    });
 *    var infowindow=new google.maps.InfoWindow({content:'24th, Street Mission, BART'});
 *    var infowindow2=new google.maps.InfoWindow({
 *                  content:'16th, Street Mission'
 *    });
 *    var route=[
 *        mark1,mark2,mark3
 *    ];
 *    var path=new google.maps.Polyline({
 *      path:route,
 *     strokeColor:"#FF0000",
 *      strokeOpacity:1.0,
 *     strokeweight:2
 *    });
 *    path.setMap(map);
 *    google.maps.event.addListener(marker,'mouseover',function(){infowindow.open(map,marker);});
 *    google.maps.event.addListener(marker,'mouseout',function(){infowindow.close();});
 *    google.maps.event.addListener(
 *                      marker2,'mouseover',function(){infowindow2.open(map,marker2);}
 *    )
 *    google.maps.event.addListener(marker2,'mouseout',function(){infowindow2.close();});
*/

} //init ends here.

/* For getRoute():-
*  Receive the route number from the user.
* Do sanity check.
* If pass, send the route number to getroute.php via an AJAX call(using jQuery).
* Receive the JSON response, parse it. 
* Add the station overlays onto the map.
* Change the center to the first station.
*/
function getRoute(routenum) {
    $(document).ready(function() {
      if(routenum=='') { return false; }
      $.getJSON('getroute.php',{route:routenum},function(data) {
    
        $.each(data,function(key,value) {
          if(key=='station') { 
            $.each(this,function(k,v) {
              //console.log("Key:- "+k);
                $.each(this,function(k2,v2) {
                console.log("[Original Key:- "+k+"][K2:- "+k2+"]- V2:-"+v2);
                });
            });
          }
          if(key=='route') { 
            alert("Key Route.");
            $.each(this,function(k,v) {
              console.log(k+" : "+v);
            });
         }
        }); //$.each
      }); //$.getJSON
    });//$(document)
}
</script>
</head>
<body onload="init();">
  <div  id="wrapper">
    <div align="center" id="controls_wrapper"><strong><p> A mashup b/w google maps and BART</p></strong>
      <div id="controls">
	<div id="test"></div>
	<p> Select a Route: </p>
	<select id="routes" onchange="getRoute(this.value);return false;">
	  <option value=""> --Select Route-- </option>
	  <option value="1"> ROUTE 1 </option>
	  <option value="2"> ROUTE 2 </option>
	  <option value="3"> ROUTE 3 </option>
	  <option value="4"> ROUTE 4 </option>
	  <option value="5"> ROUTE 5 </option>
	  <option value="6"> ROUTE 6 </option>
	  <option value="7"> ROUTE 7 </option>
	  <option value="8"> ROUTE 8 </option>
	  <option value="11"> ROUTE 11 </option>
	  <option value="12"> ROUTE 12 </option>
	</select>
      </div>
    </div><br/>
    <div id="canvas_map" align="center" ></div>
  </div>
</body>
</html>
